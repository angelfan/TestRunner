{% extends "blank.html" %}

{% block title %}
add new interface
{% endblock %}

{% block own_css %}
<link href="/static/vendor/jquery/jsoneditor.css" rel="stylesheet">
{% endblock %}

{% block navigation %}
    添加新接口
{% endblock %}

{% block content %}
    <h1>添加新的接口</h1>

    <div class="container-fluid">
	<div class="row-fluid">
		<div class="span12">

            <div class="form-inline">
                <label class="control-label">接口名称:</label>
                <input type="text" class="form-control" id="interface_name" name="interface_name"placeholder="接口名称" style="width: 500px">
                &nbsp;&nbsp;
                <label class="control-label">所属某块：</label>
                <input type="text" class="form-control" id="interface_project" name="interface_project"placeholder="所属某块" style="width: 500px">
            </div>
            <br/>
			<div class="form-group">
				<div class="btn-group">
					 <button id="dLabel" style="width: 100px" name="interface_method" type="button" class="btn btn-primary dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                        <span id='interface_method'>GET</span>
                        <span class="caret"></span>
                    </button>
					
					<ul class="dropdown-menu" aria-labelledby="dLabel">
                        <li>POST</li>
                        <li>PUT</li>
                        <li>DELETE</li>
                        <li>PATCH</li>
                        <li>HEAD</li>
                        <li>OPTIONS</li>
                    </ul>

					<div class="input-group">
						&nbsp;
						<input class="form-control" type="text" style="width: 500px" placeholder="输入url" id="interface_url"/>

						<div class="btn-group">
							&nbsp;
						<button class="btn btn-outline btn-primary" type="button" style="width: 100px" id="test_interface">SEND</button>
						<button class="btn btn-outline btn-success" type="button" style="width: 100px" id="add_interface">SAVE</button>
					</div>
					</div>

				</div>

			</div>
			<div class="tabbable tabs-below" id="tabs-857406">
				<ul class="nav nav-tabs">
					<li class="active">
						<a href="#panel-95714" data-toggle="tab">Headers</a>
					</li>
					<li>
						<a href="#panel-660949" data-toggle="tab">Body</a>
					</li>
                    <li>
						<a href="#panel-660948" data-toggle="tab">Tests</a>
					</li>
				</ul>
				<div class="tab-content" style="height: 500px">
					<div class="tab-pane active" id="panel-95714">
						<table class="table table-hover" id="header_table">
                            <thead>
                            <tr class="info">
                                <th style="width: 50px">required</th>
                                <th>key</th>
                                <th>value</th>
                            </tr>
                            </thead>
                            <tbody>
                            <tr>
                                <td><input type="checkbox" class="require_header_table" checked></td>
                                <td><input type="text" class="form-control key_header_table"></td>
                                <td><input type="text" class="form-control value_header_table"></td>
                            </tr>
                            </tbody>
                        </table>
                        <button class="btn btn-primary" id="add_headers">添加</button>
					</div>
					<div class="tab-pane" id="panel-660949">
						<p>
                        <div class="tabbable" id="tabs-518269"><!-- Only required for left/right tabs -->
                        <ul class="nav nav-tabs">

                            <li class="active body_type" id="form_data_select"><a contenteditable="true" data-toggle="tab" href="#panel-288214">
                                form-data
                            </a></li>
                            <li class="body_type" id="urlencoded_data_select"><a contenteditable="true" data-toggle="tab" href="#panel-173037">
                                x-www-form-urlencoded
                            </a></li>
                             <li class="body_type" id="JSON_data_select"><a contenteditable="true" data-toggle="tab" href="#panel-173036">
                                 JSON(application/json)
                             </a></li>
                        </ul>
                        <div class="tab-content">
                            <div class="tab-pane active" contenteditable="true" id="panel-288214">
                                <table class="table table-hover" id="form_data">
                                    <thead >
                                    <tr class="warning">
                                        <th style="width: 50px">required</th>
                                        <th>key</th>
                                        <th>value</th>
                                    </tr>
                                    </thead>
                                    <tbody>
                                    <tr>
                                        <td><input type="checkbox" class="require_form_data" checked></td>
                                        <td><input type="text" class="form-control key_form_data"></td>
                                        <td><input type="text" class="form-control value_form_data"></td>
                                    </tr>
                                    </tbody>
                                </table>
                                <button class="btn btn-primary" id="add_form_data">添加</button>
                            </div>
                            <div class="tab-pane" contenteditable="true" id="panel-173037">
                                <table class="table table-hover" id="urlencoded_data">
                                    <thead >
                                    <tr class="success">
                                        <th style="width: 50px">required</th>
                                        <th>key</th>
                                        <th>value</th>
                                    </tr>
                                    </thead>
                                    <tbody>
                                    <tr>
                                        <td><input type="checkbox" class="require_urlencoded_data" checked></td>
                                        <td><input type="text" class="form-control key_urlencoded_data"></td>
                                        <td><input type="text" class="form-control value_urlencoded_data"></td>
                                    </tr>
                                    </tbody>
                                </table>
                                <button class="btn btn-primary" id="add_urlencoded_data">添加</button>
                            </div>
                            <div class="tab-pane" contenteditable="true" id="panel-173036">

                                <div id="jsoneditor" style="height: 450px"></div>
                            </div>
                        </div>
                    </div>

						</p>
					</div>
                    <div class="tab-pane" id="panel-660948">
						test
                    </div>
                </div>
            </div>

            <div class="panel panel-primary">
                <div class="panel-heading">
                    Response
                </div>
                <div class="panel-body" style="height: 300px">
                   response
                </div>

            </div>

		</div>
	</div>
</div>

{% endblock %}

{% block own_js %}

    <script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.2.6/ace.js"></script>
    <script src="/static/vendor/jquery/jsoneditor-minimalist.js"></script>
    <script src="/static/js/test_runner/interface.js"></script>

    <script>
    // create the editor
    var container = document.getElementById('jsoneditor');
    var options = {
        modes: ['text', 'code', 'tree', 'form', 'view'],
        mode: 'code',
        ace: ace
    };
    var editor = new JSONEditor(container, options);
</script>


	<script>


	$('.dropdown-menu').on('click', function(e) {
	var $target = $(e.target);
	$target.is('li') && $('#interface_method').text($target.text())});

    $("#add_form_data").click(function(){
        $.table_add_tr("form_data");
    });

    $("#add_urlencoded_data").click(function(){
        $.table_add_tr("urlencoded_data");
    });

    $("#add_headers").click(function(){
        $.table_add_tr("header_table");
    });

    $("#form_data_select").click(function(){

        $.set_header_type("application/form-data")
    });

    $("#urlencoded_data_select").click(function(){

        $.set_header_type("application/x-www-form-urlencoded")
    });

    $("#JSON_data_select").click(function(){

        $.set_header_type("application/json")
    });

    $("#test_interface").click(function(){
        var api_data = $.get_api_data();
        var data_type = $(".active.body_type").text();
        if (data_type="form-data"){

        }
        if (data_type="x-www-form-urlencoded"){

        }
        if (data_type="x-www-form-urlencoded"){

        }
    });

	</script>

{% endblock %}